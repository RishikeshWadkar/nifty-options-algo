graph TD
    A[ğŸ MacBook Starts Bot] --> B[ğŸ“¡ Connect to Shoonya API]
    B --> C[ğŸ”Œ Open WebSocket Connection]
    C --> D[ğŸ“Š Subscribe to NIFTY Market Data]
    
    D --> E[ğŸ’¾ Collect First 15 Minutes Data<br/>9:15 AM - 9:16 AM]
    E --> F[ğŸ“ Calculate Zone Levels<br/>High/Low of first 15 min]
    
    F --> G[â° Start Live Trading Loop<br/>After 9:16 AM]
    
    G --> H[ğŸ“ˆ New Price Tick Received]
    H --> I{ğŸ¯ Price Crosses Zone?}
    
    I -->|âŒ No Signal| G
    I -->|âœ… Long Signal<br/>Price > High Zone| J[ğŸš€ Generate LONG Signal]
    I -->|âœ… Short Signal<br/>Price < Low Zone| K[ğŸ“‰ Generate SHORT Signal]
    
    J --> L[ğŸ›¡ï¸ Risk Manager Checks]
    K --> L
    
    L --> M{âš–ï¸ Risk Rules OK?}
    M -->|âŒ Risk Violation<br/>Max trades/loss reached| N[ğŸš« Block Trade]
    M -->|âœ… Risk OK| O[ğŸ“‹ Create Order]
    
    O --> P{ğŸ”§ Trading Mode?}
    P -->|ğŸ“ Paper Trading| Q[ğŸ­ Simulate Order Fill]
    P -->|ğŸ’° Live Trading| R[ğŸ“¤ Send Order to Shoonya]
    
    Q --> S[âœ… Record Simulated Execution]
    R --> T[âœ… Record Real Execution]
    
    S --> U[ğŸ’¼ Track Position]
    T --> U
    
    U --> V[ğŸ“Š Monitor for Stop Loss/Take Profit]
    V --> W{ğŸ¯ Exit Condition Met?}
    
    W -->|âŒ Continue Monitoring| V
    W -->|âœ… SL/TP Hit| X[ğŸšª Exit Position]
    
    X --> Y[ğŸ’¾ Save Trade to Database]
    Y --> Z[ğŸ“ Log P&L Results]
    
    Z --> G
    N --> G
    
    %% Styling
    classDef startEnd fill:#e1f5fe,stroke:#01579b,stroke-width:2px
    classDef process fill:#f3e5f5,stroke:#4a148c,stroke-width:2px
    classDef decision fill:#fff3e0,stroke:#e65100,stroke-width:2px
    classDef signal fill:#e8f5e8,stroke:#1b5e20,stroke-width:2px
    classDef risk fill:#ffebee,stroke:#b71c1c,stroke-width:2px
    
    class A,D,Y,Z startEnd
    class B,C,E,F,G,H,O,Q,R,S,T,U,V,X process
    class I,M,P,W decision
    class J,K signal
    class L,N risk